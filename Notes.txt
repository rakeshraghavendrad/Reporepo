import pandas as pd

# Example system prompt
system_prompt = "You are an AI model that classifies merchant documents into decisions with reasons."

predictions = []
for _, row in df.iterrows():
    user_prompt = f"""
    Merchant document:
    {row['merchant_document_extracted']}

    Based on this document, predict the decision (approve/decline/other) 
    and provide a short reason.
    """
    
    predicted = chat_completion("gemini-2.5", system_prompt, user_prompt)
    predictions.append(predicted)

df["predicted_decision"] = predictions
