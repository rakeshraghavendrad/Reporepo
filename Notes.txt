import re
import pandas as pd

# Function to clean ANSI escape codes
def remove_ansi_escape(text):
    ansi_escape = re.compile(r'\x1b\[[0-9;]*m')
    return ansi_escape.sub('', text)

# List of keywords to search for
keywords = [
    "Prompt on compelling photographic or email evidence returned",
    # Add more keywords here if needed
]

# Initialize list to store all extracted rows
records = []

# Read file
with open(input_file, "r", encoding="utf-8") as infile:
    lines = infile.readlines()

# Loop through each keyword
for keyword in keywords:
    for raw_line in lines:
        if keyword in raw_line:
            line = remove_ansi_escape(raw_line.strip())

            # Extract fields using regex
            evidence_match = re.search(r'evidence="([^"]+)"', line)
            input_match = re.search(r'input_=(\S+\.pdf)', line)
            is_compelling_match = re.search(r'is_compelling=(True|False)', line)

            # Append extracted fields to list
            records.append({
                "keyword": keyword,
                "input_": input_match.group(1) if input_match else "Not found",
                "evidence": evidence_match.group(1) if evidence_match else "Not found",
                "is_compelling": is_compelling_match.group(1) if is_compelling_match else "Not found"
            })

# Convert to DataFrame
df = pd.DataFrame(records)

# Display result
print(df)
