from sentence_transformers import SentenceTransformer
import pandas as pd
from sklearn.metrics.pairwise import cosine_similarity

# Load the model
model = SentenceTransformer('all-MiniLM-L6-v2')  # or use 'intfloat/e5-base'

# Sample DataFrame
df = pd.DataFrame({
    'A': ["The cat sits on the mat.", "A man is eating food."],
    'B': ["A cat is on the mat.", "Someone is having a meal."]
})

# Generate embeddings
embeddings_A = model.encode(df['A'].tolist(), convert_to_tensor=True)
embeddings_B = model.encode(df['B'].tolist(), convert_to_tensor=True)

# Compute cosine similarity
similarities = cosine_similarity(embeddings_A, embeddings_B).diagonal()

df['cosine_similarity'] = similarities
print(df)
